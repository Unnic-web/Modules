__version__ = (1, 0, 0)
#ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤Â© Copyright 2024
#ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤https://t.me/unnic
# ğŸ”’ã…¤ã…¤ã…¤ã…¤ã…¤Licensed under the GNU AGPLv3
# ğŸŒã…¤ã…¤https://www.gnu.org/licenses/agpl-3.0.html
#â”â”“â”â”â”“â”â”â”â”“â”â”â”â”“â”â”â”â”â”â”â”â”“â”â”â”â”â”â”â”“â”â”â”â”â”â”â”â”â”â”â”â”
#â”ƒâ”ƒâ”â”ƒâ”ƒâ”â”â”ƒâ”ƒâ”â”â”ƒâ”ƒâ”â”â”ƒâ”â”“â”â”“â”ƒâ”â”â”â”â”â”›â”—â”“â”â”â”â”â”â”â”â”â”â”â”
#â”ƒâ”—â”â”›â”ƒâ”â”“â”ƒâ”ƒâ”â”“â”ƒâ”ƒâ”â”“â”—â”›â”ƒâ”ƒâ”—â”›â”â”“â”â”“â”—â”“â”â”›â”â”â”â”“â”â”â”“â”â”â”â”
#â”ƒâ”â”â”“â”ƒâ”£â”«â”ƒâ”—â”›â”›â”ƒâ”—â”›â”›â”â”â”ƒâ”ƒâ”â”â”ƒâ”ƒâ”ƒâ”ƒâ”â”ƒâ”ƒâ”â”ƒâ”â”“â”ƒâ”ƒâ”â”›â”â”â”â”
#â”ƒâ”ƒâ”â”ƒâ”ƒâ”ƒâ”ƒâ”ƒâ”â”“â”“â”ƒâ”â”“â”“â”â”â”›â”—â”“â”â”ƒâ”—â”›â”ƒâ”â”ƒâ”—â”“â”ƒâ”—â”›â”ƒâ”ƒâ”ƒâ”â”â”â”â”
#â”—â”›â”â”—â”›â”—â”›â”—â”›â”—â”›â”—â”›â”—â”›â”â”—â”â”â”›â”â”—â”â”â”›â”â”—â”â”›â”—â”â”â”›â”—â”›â”â”â”â”â”
#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# meta banner: https://t.me/HikkTutor
# meta developer: @unnic
#â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘
#â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
#â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•
#â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—
#â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
#â–‘â•šâ•â•â•â•â•â•â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•â•šâ•â•â–‘â•šâ•â•â•â•â•
import re
from datetime import datetime
from telethon import TelegramClient
from .. import loader, utils

@loader.tds
class PremiumStatusMod(loader.Module):
    """ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ Telegram Premium Ñ‡ĞµÑ€ĞµĞ· @PremiumBot."""

    strings = {
        "name": "PremiumStatus"
    }

    def __init__(self):
        self.name = self.strings["name"]
        self._client = None

    async def client_ready(self, client: TelegramClient, db):
        self._client = client

    async def otcmd(self, message):
        """ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞµ Telegram Premium. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ: .ot"""
        await message.edit("<b>ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ, Ğ¿Ğ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ° Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ...</b>")

        try:
            bot_username = 'PremiumBot'
            async with self._client.conversation(bot_username) as conv:
                start_message = await conv.send_message('/start')
                response = await conv.get_response()
                await start_message.delete()

                if response.message and "ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ ÑĞ²Ğ¾Ğ¸Ğ¼Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸ Ğ² ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ¼ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹" in response.message:
                    await message.edit("<b>Ğ£ Ğ²Ğ°Ñ Ñ…Ğ°Ğ»ÑĞ²Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°, ÑĞ¿Ñ€Ğ¾ÑĞ¸Ñ‚Ğµ Ñƒ Ñ‚Ğ¾Ğ³Ğ¾, ĞºÑ‚Ğ¾ Ğ²Ğ°Ğ¼ ĞµÑ‘ Ğ¿Ğ¾Ğ´Ğ°Ñ€Ğ¸Ğ», ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ ĞµÑ‰Ñ‘ Ğ´Ğ½ĞµĞ¹ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ.</b>")
                elif response.message:
                    match = re.search(r'ğŸ“† Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿Ğ»Ğ°Ñ‚Ñ‘Ğ¶: (.*?), (\d{2}\.\d{2}\.\d{4})\.', response.message)
                    if match:
                        full_date = match.group(2)
                        expiry_date = datetime.strptime(full_date, '%d.%m.%Y')
                        remaining_days = (expiry_date - datetime.now()).days
                        await message.edit(f"<b>Ğ”Ğ¾ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ Premium Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ: <code>{remaining_days}</code> Ğ´Ğ½ĞµĞ¹.</b>")
                    else:
                        await message.edit("<b>ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ´Ğ°Ñ‚Ñƒ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸.</b>")
                else:
                    await message.edit("<b>ĞÑˆĞ¸Ğ±ĞºĞ°: ĞÑ‚Ğ²ĞµÑ‚ Ğ¾Ñ‚ Ğ±Ğ¾Ñ‚Ğ° Ğ¿ÑƒÑÑ‚ Ğ¸Ğ»Ğ¸ Ğ¸Ğ¼ĞµĞµÑ‚ Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½ÑƒÑ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ.</b>")

        except Exception as e:
            await message.edit(f"<b>ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: {e}</b>")
