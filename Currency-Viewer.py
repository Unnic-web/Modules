__version__ = (1, 0, 1)
#ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤Â© Copyright 2024
#ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤ã…¤https://t.me/unnic
# ğŸ”’ã…¤ã…¤ã…¤ã…¤ã…¤Licensed under the GNU AGPLv3
# ğŸŒã…¤ã…¤https://www.gnu.org/licenses/agpl-3.0.html
#â”â”“â”â”â”“â”â”â”â”“â”â”â”â”“â”â”â”â”â”â”â”â”“â”â”â”â”â”â”â”“â”â”â”â”â”â”â”â”â”â”â”â”
#â”ƒâ”ƒâ”â”ƒâ”ƒâ”â”â”ƒâ”ƒâ”â”â”ƒâ”ƒâ”â”â”ƒâ”â”“â”â”“â”ƒâ”â”â”â”â”â”›â”—â”“â”â”â”â”â”â”â”â”â”â”â”
#â”ƒâ”—â”â”›â”ƒâ”â”“â”ƒâ”ƒâ”â”“â”ƒâ”ƒâ”â”“â”—â”›â”ƒâ”ƒâ”—â”›â”â”“â”â”“â”—â”“â”â”›â”â”â”â”“â”â”â”“â”â”â”â”
#â”ƒâ”â”â”“â”ƒâ”£â”«â”ƒâ”—â”›â”›â”ƒâ”—â”›â”›â”â”â”ƒâ”ƒâ”â”â”ƒâ”ƒâ”ƒâ”ƒâ”â”ƒâ”ƒâ”â”ƒâ”â”“â”ƒâ”ƒâ”â”›â”â”â”â”
#â”ƒâ”ƒâ”â”ƒâ”ƒâ”ƒâ”ƒâ”ƒâ”â”“â”“â”ƒâ”â”“â”“â”â”â”›â”—â”“â”â”ƒâ”—â”›â”ƒâ”â”ƒâ”—â”“â”ƒâ”—â”›â”ƒâ”ƒâ”ƒâ”â”â”â”â”
#â”—â”›â”â”—â”›â”—â”›â”—â”›â”—â”›â”—â”›â”—â”›â”â”—â”â”â”›â”â”—â”â”â”›â”â”—â”â”›â”—â”â”â”›â”—â”›â”â”â”â”â”
#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# meta banner: https://t.me/HikkTutor
# meta developer: @unnic
#â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘
#â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
#â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•
#â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—
#â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
#â–‘â•šâ•â•â•â•â•â•â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•â•šâ•â•â–‘â•šâ•â•â•â•â•

from .. import loader, utils # ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€
from telethon.tl.types import Message # type: ignore
import requests

class CurrencyMod(loader.Module): # ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€
    """ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ ĞºÑƒÑ€ÑĞ¾Ğ²"""

    strings = {
        "name": "Currency",
        "inc_args": "<emoji document_id=5787544344906959608>â„¹ï¸</emoji> <b>ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹</b>",
        "keyerror": "<emoji document_id=5787544344906959608>â„¹ï¸</emoji> <b>Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾, Ğ²Ğ°Ğ»ÑÑ‚Ğ° Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ² Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… ÑĞ°Ğ¹Ñ‚Ğ° Ğ¸Ğ»Ğ¸ Ğ²Ñ‹ Ğ²Ğ²ĞµĞ»Ğ¸ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ.</b>",
        "currency_not_supported": "<emoji document_id=5787544344906959608>â„¹ï¸</emoji> <b>Ğ”Ğ°Ğ½Ğ½Ğ°Ñ Ğ²Ğ°Ğ»ÑÑ‚Ğ° Ğ½Ğµ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ.</b>"
    }

    async def cvcmd(self, message: Message): # ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€
        """Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ .cv <Ñ‡Ğ¸ÑĞ»Ğ¾> <Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²Ğ°Ğ»ÑÑ‚Ñ‹>."""
        args = utils.get_args_raw(message)
        tray = "RUB"
        if not args:
            args = "1 " + tray

        args_list = args.split(" ")
        try:
            if len(args_list) == 1 and isinstance(float(args_list[0]), float):
                args_list.append(str(tray))
        except Exception:
            args_list = ["1", args_list[0]]
        
        currency = args_list[1].upper()
        api_url = f"https://min-api.cryptocompare.com/data/price?fsym={currency}&tsyms=USD,RUB,UAH,KZT,EUR,BYN,GBP,CHF,JPY,TON,NOT"
        api_response = requests.get(api_url).json()

        if 'Response' in api_response and api_response['Response'] == 'Error':
            await utils.answer(message, self.strings("currency_not_supported"))
            return
        
        try:
            count = float(args_list[0])
            form = (
                "<b>ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ ĞºÑƒÑ€ÑÑƒ: {} {}</b>\n<b>Ğ¡Ğ²ĞµĞ¶Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:</b>\n\n"
                "<code>{}$ </code> Ğ”Ğ¾Ğ»Ğ°Ñ€\n"
                "<code>{}â‚½ </code> Ğ ÑƒĞ±Ğ»ÑŒ\n"
                "<code>{}â‚´ </code> Ğ“Ñ€Ğ¸Ğ²Ğ½Ğ°\n"
                "<code>{}â‚¸ </code> Ğ¢ĞµĞ½Ğ³Ğµ\n"
                "<code>{}â‚¬ </code> Ğ•Ğ²Ñ€Ğ¾\n"
                "<code>{}Br</code> Ğ‘ÑƒĞ½\n"
                "<code>{}Â£ </code> Ğ¤ÑƒĞ½Ñ‚\n"
                "<code>{}â‚£ </code> Ğ¤Ñ€Ğ°Ğ½Ğº\n"
                "<code>{}Â¥ </code> Ğ™ĞµĞ½Ğ°\n"
                "<code>{}â‚® </code> Ğ¢Ğ¾Ğ½ĞºĞ¾Ğ¸Ğ½\n"
                "<code>{}â‚µ </code> ĞĞ¾Ñ‚ĞºĞ¾Ğ¸Ğ½\n"
            ).format(
                count,
                currency,
                round(api_response.get("USD", 0) * count, 2),
                round(api_response.get("RUB", 0) * count, 2),
                round(api_response.get("UAH", 0) * count, 2),
                round(api_response.get("KZT", 0) * count, 2),
                round(api_response.get("EUR", 0) * count, 2),
                round(api_response.get("BYN", 0) * count, 2),
                round(api_response.get("GBP", 0) * count, 2), 
                round(api_response.get("CHF", 0) * count, 2),
                round(api_response.get("JPY", 0) * count, 2),
                round(api_response.get("TON", 0) * count, 2),
                round(api_response.get("NOT", 0) * count, 2)
            )

            result_message = await utils.answer(message, form)
        except KeyError:
            await utils.answer(message, self.strings("keyerror"))
        except ValueError:
            await utils.answer(message, self.strings("inc_args"))


    async def cvicmd(self, message: Message): # Ğ’ÑÑĞºĞ¾Ğµ Ğ¸ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€
        """Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ²Ğ°Ğ»ÑÑ‚"""
        instruction = (
            "<b>Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ²Ğ°Ğ»ÑÑ‚</b>\n\n"
            "<code>USD</code> <b>(Ğ”Ğ¾Ğ»Ğ°Ñ€)</b>\n"
            "<code>RUB</code> <b>(Ğ ÑƒĞ±Ğ»ÑŒ)</b>\n"
            "<code>UAH</code> <b>(Ğ“Ñ€Ğ¸Ğ²Ğ½Ğ°)</b>\n"
            "<code>KZT</code> <b>(Ğ¢ĞµĞ½Ğ³Ğµ)</b>\n"
            "<code>EUR</code> <b>(Ğ•Ğ²Ñ€Ğ¾)</b>\n"
            "<code>BYN</code> <b>(Ğ‘ÑƒĞ½)</b>\n"
            "<code>JPY</code> <b>(Ğ™ĞµĞ½Ğ°)</b>\n"
            "<code>GBP</code> <b>(Ğ¤ÑƒĞ½Ñ‚)</b>\n"
            "<code>CHF</code> <b>(Ğ¤Ñ€Ğ°Ğ½Ğº)</b>\n\n"
            "<code>TON</code> <b>(Ğ¢Ğ¾Ğ½ĞºĞ¾Ğ¸Ğ½)</b>\n"
            "<code>NOT</code> <b>(ĞĞ¾Ñ‚ĞºĞ¾Ğ¸Ğ½)</b>\n\n"
            "<b>Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ·:</b> <code>.cv</code> <ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾> <Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ>"
        )
        await message.edit(instruction, parse_mode='html')
        # Ğ¥ĞµÑ€ # Ğ¥ĞµÑ€Ğ½Ñ # Ğ¥ĞµÑ€Ğ°Ñ‚ĞµĞ½ÑŒ # ĞĞ°Ñ…ĞµÑ€ # Ğ—Ğ°Ñ…ĞµÑ€ # ĞŸĞ¾Ñ…ĞµÑ€
        # ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ                     # ĞĞµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ
		# Ğ˜Ğ´ĞµÑ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€Ğ°              # ĞšĞ¾Ğ´ĞµÑ€ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€ 
	    # ĞĞ²Ñ‚Ğ¾Ñ€Ñ‹    Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ    ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€     Ğ¸     Ğ’ÑÑĞºĞ¾Ğµ
